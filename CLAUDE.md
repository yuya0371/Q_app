# Claude Code プロジェクト設定

このファイルはClaude Codeが自動的に読み込む設定ファイルです。

---

## プロジェクト概要

- **プロジェクト名**: Q.（仮）
- **種類**: モバイルアプリ + バックエンド
- **技術スタック**:
  - モバイル: React Native (Expo)
  - バックエンド: AWS CDK (TypeScript) + Lambda + DynamoDB
  - 認証: Amazon Cognito

---

## 重要なドキュメント

| ドキュメント | パス | 内容 |
|-------------|------|------|
| API設計書 | `docs/API設計書.md` | APIエンドポイント定義 |
| DB設計書 | `docs/DB設計書.md` | DynamoDBテーブル定義 |
| 画面設計書 | `docs/画面設計書.md` | モバイルアプリ画面設計 |
| タスク管理表 | `docs/タスク管理表.md` | 開発タスク一覧 |
| 開発ルール | `docs/開発ルール.md` | 開発運用ルール |
| トラブルシューティング | `docs/開発トラブルシューティング.md` | 過去の問題と解決方法 |

---

## 必須ルール（必ず遵守すること）

### 1. 要件定義書との照合（最重要）
- **実装を開始する前に、必ず `docs/要件定義書.md` の該当セクションを読む**
- **実装完了後に、要件定義書の仕様通りに実装されているか確認する**
- 特に数値・時刻・条件に関する仕様は厳密に確認する
- DB設計書に定義されているフィールドは、必ず実装で使用する

### 2. 実装前の設計書確認
- 実装を開始する前に、関連する設計書（API設計書、DB設計書）を必ず確認する
- 設計書に記載のない機能を実装する場合は、先に設計書を更新する

### 3. 実装後の設計書同期
- **実装作業が完了したら、必ず設計書との整合性を確認し更新する**
- 実装を正とし、設計書を実装に合わせる
- 変更理由を※注釈で明記する
- 未実装の機能は「❌ TODO」マークを付ける

### 3. トラブルシューティングの記録
- 開発中に発生した問題と解決方法は `docs/開発トラブルシューティング.md` に追記する
- 発生日、症状、原因、解決方法、教訓を記載する

### 4. API実装時の注意
- HTTPメソッドは設計書と一致させる（PATCH vs PUT に注意）
- DynamoDBのGSI名・属性名は `database-stack.ts` の定義を確認する
- 特に `followeeId`（`followingId`ではない）に注意

### 5. CDK開発時の注意
- API Gatewayで固定パス（`me`）は変数パス（`{userId}`）より先に定義する
- 新規Lambda追加時は環境変数の設定を忘れない

---

## タスク完了時のチェックリスト

実装タスクを完了する際は、以下を確認すること：

```
□ 要件定義書の仕様通りに実装されているか確認した
□ DB設計書に定義されたフィールドが全て使われているか確認した
□ 機能が正常に動作することを確認した
□ API設計書を実装と同期した（変更があれば）
□ DB設計書を実装と同期した（変更があれば）
□ タスク管理表のステータスを更新した
□ 問題が発生した場合はトラブルシューティングに追記した
```

---

## よく使うコマンド

### バックエンドデプロイ
```bash
cd infra && npx cdk deploy --all --require-approval never
```

### CloudWatchログ確認
```bash
aws logs tail /aws/lambda/dev-q-{function-name} --since 10m --format short
```

### モバイルアプリ起動
```bash
cd apps/mobile && npx expo start
```

---

## 禁止事項

- **要件定義書を確認せずに実装を開始すること**
- 設計書を確認せずに実装を開始すること
- 実装後に設計書を更新せずに作業を終了すること
- DB設計書に定義されたフィールドを使用せずに実装すること
- 暫定的な実装（固定値等）を本来の仕様に戻さずに放置すること
- TODOコメントにタスク番号を記載しないこと
- トラブルを解決した後にドキュメントに記録しないこと
